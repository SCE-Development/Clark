{
	"name": "OfficerDossier",
	"type": "view",
    "desc": "An optional description of the schema. Note that this.view is only required if this.type == 'view'. Note that the ppk string is optional. Note that this.textIndex is optional but is only valid if this.type == 'collection'.",
    "view": {
        "source": "Member",
        "pipeline": [
					{
						"$lookup": {
							"from": "MembershipData",
							"localField": "memberID",
							"foreignField": "memberID",
							"as": "memPlanData"
						}
					},
					{
						"$match": {
							"$or": [
								{
									"memPlanData.level": 0
								},
								{
									"memPlanData.level": 1
								}
							]
						}
					},
					{
						"$lookup": {
							"from": "ClearanceLevel",
							"localField": "memPlanData.level",
							"foreignField": "cID",
							"as": "clevel"
						}
					},
					{
						"$replaceRoot": {
							"newRoot": {
								"memberID": "$memberID",
								"fullName": {
									"$concat": ["$firstName"," ", "$middleInitial", " ", "$lastName"]
								},
								"userName": "$userName",
								"email": "$email",
								"lastLogin": "$lastLogin",
								"level": "$clevel.cID",
								"levelName": "$clevel.levelName",
								"abilities": "$clevel.abilities"
							}
						}
					},
					{
						"$unwind": "$levelName"
					},
					{
						"$unwind": "$level"
					},
					{
						"$unwind": "$abilities"
					}
        ]
    },
    "members": {
			"memberID": "number",
			"fullName": "string",
			"userName": "string",
			"email": "string",
			"lastLogin": "string",
			"level": "number",
			"levelName": "string",
			"abilities": "array"
    }
}
