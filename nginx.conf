http {
    # Run nginx with "npm run start-production"
    # Stop nginx with "npm run stop-production"
    # Reload nginx without stopping server "npm reload-production"

    #logging
    access_log  /var/log/nginx/sce.access.log;

    #upstream connection to node servers from npm run server
    upstream webserver {
        server frontend:3000;
    }
    upstream jenkins {
        server localhost:8080;
    }

    # actual nginx server
    server {

        # listen to 80(http) and 443(https)
        listen 80;
        listen 443 ssl;

        # ssl certificate
        ssl_certificate sce_engr_sjsu_edu.cer;
        ssl_certificate_key sce.key;
        # TLS protocol (remember to update to the newest protocols for best security)
        ssl_protocols TLSv1.3;

        #Load balancer
        location /jenkins {
            proxy_pass http://jenkins;
        }
		location / {
            proxy_pass http://webserver;
        }
    }
}

events { }